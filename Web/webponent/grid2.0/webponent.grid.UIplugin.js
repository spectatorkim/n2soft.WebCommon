webponent.grid.UIplugin=(function(){var d={};function b(k,v){var x=$(k.markup.area);var m=null;if(v.filteringButton){m=v.filteringButton;}else{m=$('<button type="button" class="ci-grid-filtering-opener">');m.outerWidth(k.settings.scrollBarWidth);m.outerHeight($(k.markup.main.header.wrapper).height());x.append(m);}var u={};var z=$('<div class="ci-grid-filtering-panel-wrapper">');var t=$('<div class="ci-grid-filtering-panel">');var p=$('<div class="ci-grid-filtering-panel-inner">');var n=$('<div class="ci-grid-filtering-panel-scroll-indi">');n.css({width:k.settings.scrollBarWidth,height:k.settings.scrollBarWidth});z.hide();t.append(p);z.append(t);z.append(n);x.append(z);var y=x.width();z.outerWidth(y);z.css("top",k.markup.main.header.wrapper.clientHeight+1);t.outerWidth(y-k.settings.scrollBarWidth-4);z.on("mousedown",function(){z.css("cursor","-webkit-grabbing");});z.on("mouseup",function(){z.css("cursor","-webkit-grab");});z.draggable({axis:"y",containment:x});z.on("mouseenter",function(){z.stop(true,true);z.addClass("ci-grid-filtering-panel-wrapper-focused",300,"easeOutQuint");});z.on("mouseleave",function(){if(z.find(":focus").length===0){z.stop(true,true);z.removeClass("ci-grid-filtering-panel-wrapper-focused",300,"easeOutQuint");}});var l=k.settings.columns;function A(B,C){if(v.filteringUIFunction){v.filteringUIFunction(k,B,C);return;}k.filterColumn(B,C);}var o=_.debounce(A,300);var i=true;var w=k.markup.main.header.thead;if($(w).find("tr").length>1){i=false;}if(i){_.each(l,function(D,C,E){var B=$('<input type="text" class="ci-grid-filtering-input">');u[D.name]=B;B.outerWidth(D.width-20);B.css("text-align",D.align);B.on("keyup",function(){o(D.name,$.trim(B.val()));});p.append(B);if(D.visibility!="visible"){B.hide();}});}else{_.each(l,function(D,C,E){if(D.parentColumn!==null){var B=$('<input type="text" class="ci-grid-filtering-input">');u[D.name]=B;B.outerWidth(D.width-20);B.css("text-align",D.align);B.on("keyup",function(){o(D.name,$.trim(B.val()));});p.append(B);if(D.visibility!="visible"){B.hide();}}});}var l=k.settings.columns;var q=_.filter(l,function(B){return B.fixed;}).length;k.on("scroll",function(E,B,D,C){if(q>0){_.each(l,function(H,G,I){if(H.visibility=="visible"){var F=u[H.name];if(F){u[H.name].show();}}else{var F=u[H.name];if(F){u[H.name].hide();}}});}else{t.scrollLeft(C);}});k.on("columnResized",function(D,B,C){var E=u[C.name];if(C.visibility=="visible"){E.show();}else{E.hide();}E.outerWidth(C.width-20);});function j(){_.each(l,function(C,B,E){if(i){if(C.visibility=="visible"){var F=u[C.name];var D=C.width;if(C.width===null){D=$(C.header).outerWidth();}F.outerWidth(D-20);}}else{if(C.visibility=="visible"&&C.parentColumn){var F=u[C.name];var D=C.width;if(C.width===null){D=$(C.header).outerWidth();}F.outerWidth(D-20);}}});}function r(){var B=x.width();z.outerWidth(B);t.outerWidth(B-k.settings.scrollBarWidth-4);j();}var s=_.debounce(r,50);$(window).resize(function(){s();});m.on("click",function(){var B=k.settings.filtering.conditions;if(!jQuery.isEmptyObject(B)){m.addClass("ci-grid-filtering-applied");}else{m.removeClass("ci-grid-filtering-applied");}if(m.hasClass("filtering-opened")){z.hide();}else{r();z.show();z.addClass("ci-grid-filtering-panel-wrapper-focused");}m.toggleClass("filtering-opened");});}function c(j,t){var s=$(j.markup.area);j.extention.columnSetting={};var n=null;if(t.settingButton){n=t.settingButton;}else{n=$('<button type="button" class="ci-grid-setting-opener">');$(j.markup.area).prepend(n);}var r=$("<div>");var l=$('<div class="ci-grid-setting-manual-panel">');var q=$('<ul class="ci-grid-setting-manual">');q.append("<li>체크박스를 이용해서 컬럼의 보임/숨김을 선택 할 수 있습니다.</li>");q.append("<li>컬럼을 드래그해서 컬럼의 표시 순서를 변경 할 수 있습니다.</li>");q.append("<li>고정아이콘을 클릭하면 해당 컬럼까지를 스크롤이 안되게 고정 시킬 수 있습니다.</li>");l.append(q);r.append(l);var x=$('<ul class="ci-grid-setting-column-container">');x.disableSelection();var p=j.settings.columns;function m(B){x.find(".ci-grid-setting-column").remove();var z=x.outerWidth(true);var F=4;if(z<550){F=2;}if(z<350){F=1;}var D=(z-21)/F;var C=[];var A=[];var E=[];_.each(p,function(L,J,M){var N=$('<li class="ci-grid-setting-column">');N.data("name",L.name);N.outerWidth(D,true);var K=$('<button type="button" class="ci-grid-setting-column-visibility-mark">');K.data("name",L.name);if(L.visibility=="hidden"){K.addClass("ci-grid-setting-column-visibility-mark-hidden");K.attr("title","컬럼이 숨겨져 있습니다.");K.data("flag",false);}else{K.removeClass("ci-grid-setting-column-visibility-mark-hidden");K.attr("title","컬럼이 보여집니다.");K.data("flag",true);}A.push(K);N.append(K);var I=$('<span class="ci-grid-setting-column-name"></span>');var G=$(L.header).find(".CI-GRID-HEADER-TITLE").text();I.text(G);I.attr("title",G);I.width(D-60);N.append(I);var H=$('<button type="button" class="ci-grid-setting-column-fixed-mark">');H.data("name",L.name);H.attr("title","여기까지 고정하기");if(L.fixed){N.addClass("ci-grid-setting-column-fixed");H.addClass("ci-grid-setting-column-fixed-mark-fixed");H.data("flag",true);}else{N.removeClass("ci-grid-setting-column-fixed");H.remove("ci-grid-setting-column-fixed-mark-fixed");H.data("flag",false);}E.push(H);N.append(H);C.push(N);x.append(N);});B.extention.columnSetting.columnLiArray=C;B.extention.columnSetting.visibilityMarkArray=A;B.extention.columnSetting.fixedMarkArray=E;i();y();k();}function y(){var z=j.extention.columnSetting.visibilityMarkArray;var A=j.extention.columnSetting.fixedMarkArray;_.each(z,function(C,B,D){C.on("click",function(){if(A[B].data("flag")){return;}if(C.data("flag")){C.addClass("ci-grid-setting-column-visibility-mark-hidden");C.data("flag",false);}else{C.removeClass("ci-grid-setting-column-visibility-mark-hidden");C.data("flag",true);}});});}function v(){var z=j.extention.columnSetting.visibilityMarkArray;_.each(z,function(B,A,C){B.off("click");});}function k(){var A=j.extention.columnSetting.columnLiArray;var z=j.extention.columnSetting.visibilityMarkArray;var B=j.extention.columnSetting.fixedMarkArray;_.each(B,function(C,D,E){C.on("click",function(){x.sortable("destroy");var F=_.filter(B,function(H){return H.data("flag")===true;}).length;_.each(B,function(H,I,J){A[I].removeClass("ci-grid-setting-column-fixed");H.removeClass("ci-grid-setting-column-fixed-mark-fixed");H.data("flag",false);});for(var G=0;G<=D;G++){A[G].addClass("ci-grid-setting-column-fixed");B[G].addClass("ci-grid-setting-column-fixed-mark-fixed");B[G].data("flag",true);z[G].removeClass("ci-grid-setting-column-visibility-mark-hidden");z[G].data("flag",true);}if(D===0&&F===1){A[0].removeClass("ci-grid-setting-column-fixed");C.removeClass("ci-grid-setting-column-fixed-mark-fixed");C.data("flag",false);}i();});});}function w(){var z=j.extention.columnSetting.fixedMarkArray;_.each(z,function(A,B,C){A.off("click");});}function i(){x.sortable({items:".ci-grid-setting-column:not(.ci-grid-setting-column-fixed)",update:function(){v();w();var C=x.find(".ci-grid-setting-column");var E=j.extention.columnSetting.columnLiArray;var B=j.extention.columnSetting.visibilityMarkArray;var G=j.extention.columnSetting.fixedMarkArray;C.each(function(I){var H=$(this);var J=H.data("name");var K=_.find(E,function(L){return L.data("name")===J;});K.data("index",I);});var A=[];for(var D=0,z=E.length;D<z;D++){A.push({columnLi:E[D],visibilityMark:B[D],fixedMark:G[D]});}var F=_.sortBy(A,function(H){return H.columnLi.data("index");});for(var D=0,z=F.length;D<z;D++){E[D]=F[D].columnLi;B[D]=F[D].visibilityMark;G[D]=F[D].fixedMark;}j.extention.columnSetting.columnLiArray=E;j.extention.columnSetting.visibilityMarkArray=B;j.extention.columnSetting.fixedMarkArray=G;y();k();}});}function o(C){var D=C.extention.columnSetting.columnLiArray;var B=C.extention.columnSetting.visibilityMarkArray;var E=C.extention.columnSetting.fixedMarkArray;var A=[];_.each(D,function(H,F,G){A.push(H.data("name"));});C.setColumnOrder(A);_.each(B,function(I,H,J){var F=I.data("flag");var G=I.data("name");if(F){C.setColumnVisibility(G,true);}else{C.setColumnVisibility(G,false);}});var z=_.filter(E,function(F){return F.data("flag")===true;}).length-1;if(z>-1){C.setFixedColumn(z);}else{C.destroyFixedColumn();}}r.append(x);var u=r.dialog({open:function(z,A){var C=j.markup.area.clientWidth;var B=0.8;if(C<500){B=0.95;}if(C>700){B=0.65;}$(this).dialog("option","width",s.width()*0.8);m(j);$(this).dialog({position:{at:"center",of:s,my:"center"}});},close:function(z,A){n.data("opened",false);},title:"컬럼 설정",dialogClass:"ci-grid-setting-dialog",appendTo:s,position:{my:"center",at:"center",of:s},resizable:false,draggable:false,width:s.width()*0.8,buttons:[{text:"되돌리기",click:function(){m(j);}},{text:"취소",click:function(){$(this).dialog("close");}},{text:"확인","class":"ci-dialog-button-save",click:function(){$(this).dialog("close");o(j);}}]});u.dialog("close");n.data("opened",false);n.on("click",function(){if(n.data("opened")){u.dialog("close");n.data("opened",false);}else{u.dialog("open");n.data("opened",true);}});}function h(j,l,m){var i=l.paging;j.setPageLayout(i);if(i.type=="server"){var k=webponent.pagingUI.init($(j.markup.area),i);m.pagingUI=k;k.on("refreshPagingUI",function(o,n){j.setPageLayout(n);});}else{if(i.type=="client"){j.makePageList();}}}function e(k){var m=$(k.markup.area);var j=k.settings.columns;var l=k.settings.grouping.groups;var i=[];_.each(l,function(q,p,n){var o=$('<ul class="ci-grid-grouping-ul">');_.each(q,function(y,x,w){var u=k.getColumnInfo(y);var t=$(u.header);t.off("click");var v=$(u.header).find(".CI-GRID-HEADER-TITLE").text();var r=$('<li class="ci-grid-grouping-ul-li">');var s=$('<a href="#" class="ci-grid-grouping-ul-column"/>').text(v);r.attr("data-name",u.name);s.data("name",u.name);s.on("click",function(A){A.preventDefault();var z=_.find(j,function(B){return B.grouping.groupNumber===u.grouping.groupNumber&&B.visibility=="visible";});k.setColumnVisibility(z.name,false);k.setColumnVisibility($(this).data("name"),true);o.hide();});t.on("click.extendedGroupingUI",function(){if(o.is(":visible")){o.hide();}else{o.show();o.find(".ci-grid-grouping-ul-li").show();o.position({my:"left top",at:"left-1 bottom",of:t,collision:"none"});o.css("min-width",u.width+1+"px");var z=o.find('[data-name="'+u.name+'"]');z.hide();}});r.append(s);o.append(r);});m.append(o);i.push(o);});_.each(i,function(n,o,p){n.find(".ci-grid-grouping-ul-li").height(k.settings.trHeight);});k.on("scroll columnResized",function(){_.each(i,function(n,o,p){n.hide();});});}function a(i){function j(n,r,l){var k=r.find(".CI-GRID-EDITING-INPUT");var m=$.trim(k.val());var q=n[0].rowKey;var p={};var o=r.attr("data-name");p[o]=m;if(l===m){i.settings.option.updateCallback=false;}i.updateNode(q,p);i.updateData(q,p);i.settings.option.updateCallback=true;r.removeClass("CI-GRID-EDITING-CELL");k.remove();}$(i.markup.main.body.tbody).on("click","td",function(){var n=$(this);var l=n.closest("tr");if(!n.hasClass("CI-GRID-EDITING-CELL")){var m=$('<input class="CI-GRID-EDITING-INPUT" type="text">');m.css({padding:n.css("padding"),"font-size":n.css("font-size"),color:n.css("color"),"text-align":n.css("text-align")});n.addClass("CI-GRID-EDITING-CELL");var k=$.trim(n.html());m.val(k);n.append(m);m.focus();m.blur(function(o){j(l,n,k);});m.on("keydown",function(p){p.stopPropagation();var o=p.keyCode;if(o===13){j(l,n,k);}});}});}function g(k,i){var l=i.depthKey;var m={};k.event.on("rowAppended",function(){var o=k.data;var p=k.settings.rows;var n=[];var s=-1;var r=[];_.each(o,function(v,t){var u=v[l]*1;if(u!==0){n.push(t);}m[t]=[];if(u>s){r[u]=t;}else{if(u<s){r[u]=t;}}if(u>0){m[r[u-1]].push(t);}s=u;});k.setRowVisibility(n,false);var q=k.rows;_.each(m,function(v,z){var y=o[z][l];var x=$(q[z]);var t=x.find("td").eq(0);if(v.length>0){var w=$('<i tabindex="0" class="ci-grid-tree-indi"/>');t.prepend(w);w.data("opened",false);for(var u=0;u<y;u++){t.prepend('<i class="ci-grid-depth-indi"/>');}w.on("click",function(){if(!w.data("opened")){w.addClass("ci-grid-tree-indi-opened");k.setRowVisibility(v,true);w.data("opened",true);}else{j(z,v);}});}for(var u=0;u<y;u++){t.prepend('<i class="ci-grid-depth-indi"/>');if(v.length==0){t.prepend('<i class="ci-grid-depth-indi"/>');t.prepend('<i class="ci-grid-depth-indi"/>');}}});});function j(p,n){if(n.lenth==0){return;}var o=$(k.rows[p]).find(".ci-grid-tree-indi");o.removeClass("ci-grid-tree-indi-opened");o.data("opened",false);k.setRowVisibility(n,false);_.each(n,function(q){j(q,m[q]);});}}function f(i,j){var m=document;function l(o){var n=m.createElement("span");n.className="CI-GRID-ELEVEN-TREE-TITLE";n.innerHTML=o+" : ";return $(n);}function k(r,p){var o=r;var n=o.attributes;var t=document.createElement(p);for(var q=n.length-1;q>=0;q--){var s=n[q];t.setAttribute(s.name,s.value);}t.innerHTML=o.innerHTML;return $(t);}i.event.on("rowAppended",function(){var v=i.data;var r=i.settings.columns;var B=i.rows;var z=0;var o=0;var q="auto";if(_.has(j,"widths")){var p=_.filter(j.widths,function(C){return C.split("p").length>1;});if(p.length===j.widths.length){_.each(j.widths,function(E,D,F){if(D===j.widths.length-1){var C=Number(j.widths[D].split("px")[0]);j.widths[D]=C-i.settings.scrollBarWidth;}});q=j.widths;}else{q=j.widths;}}var y=$(i.markup.main.header.thead);var u=$(i.markup.main.body.thead);var w=y.find("th");var t=u.find("th");var n=$("<th>"),x=n.clone();_.each(r,function(D,C,E){if(C==0){$(y.find("tr")).prepend(n.attr("name","CI_GRID_ELEVEN_HEAD_CELL"));$(u.find("tr")).prepend(x.addClass("CI-GRID-BODY-TABLE-THEAD-CELL").attr("name","CI_GRID_ELEVEN_BODY_CELL"));}if(D.elevenTree){o+=1;}else{$(w[C]).remove();$(t[C]).remove();}});var A=$("<div>");_.each(B,function(H,D,G){var C=$(H).find("th:visible, td:visible");var E=$("<div>");E.addClass("CI-GRID-ELEVEN-TD-CONTENT");_.each(r,function(L,K,M){if(K==0){var J='<td><i tabindex="0" class="ci-grid-tree-indi"/></td>';J=$(J);$(H).prepend(J);}if(!L.elevenTree){var O=k($(C[K])[0],"div");var N=l(L.label);O.prepend(N);E.append(O);$(C[K]).remove();}});var F=$("<tr>");F.attr({tabindex:0,"class":$(H).attr("class")}).addClass("CI-GRID-ELEVEN-TR");var I=$("<td>");I.attr("colspan",o+1).append(E).addClass("CI-GRID-ELEVEN-TD");F.append(I).hide();$(H).after(F);});var s=0;$(i.markup.wrapper).find("[name=CI_GRID_ELEVEN_HEAD_CELL]").css({width:q==="auto"?"auto":q[s],"min-width":q==="auto"?"auto":q[s],"max-width":q==="auto"?"none":q[s]});$(i.markup.wrapper).find("[name=CI_GRID_ELEVEN_BODY_CELL]").css({width:q==="auto"?"auto":q[s],"min-width":q==="auto"?"auto":q[s],"max-width":q==="auto"?"none":q[s]});_.each(r,function(E,D,F){if(E.elevenTree){$(E.header).css({width:q==="auto"?"auto":q[s+1],"min-width":q==="auto"?"auto":q[s+1],"max-width":q==="auto"?"none":q[s+1]});$(E.copiedHeader).css({width:q==="auto"?"auto":q[s+1],"min-width":q==="auto"?"auto":q[s+1],"max-width":q==="auto"?"none":q[s+1]});s++;}var C=$(E.micelinous);C.hide();});_.each(i.markup.functional.resizers,function(E,C,D){$(E).hide();});$(i.markup.wrapper).find(".ci-grid-tree-indi").on("click",function(G){G.preventDefault();var D=$(this);if(!D.data("opened")){D.addClass("ci-grid-tree-indi-opened");D.closest("tr").next().show();D.data("opened",true);}else{D.removeClass("ci-grid-tree-indi-opened");D.data("opened",false);D.closest("tr").next().hide();}var F=$(i.markup.main.body.tbody);var C=$(i.markup.functional.freezeScrollerInner);var E=F.height();C.height(E);$(i.markup.functional.freezeScroller).getNiceScroll().resize();if(i.settings.mobile){i.resetMobileScrollY();}});});}d.init=function(i,j){var k={};i.extention={};if(!j){j={};}if(j.filteringUI===true){b(i,j);}if(j.settingUI===true){c(i,j);}if(j.paging){h(i,j,k);}if(j.groupingUI===true){e(i);}if(j.report===true){makeReportUI(i);}if(j.editable===true){a(i);}if(j.tree){g(i,j.tree);}if(j.ajaxTree){makeAjaxTreeUI(i,j.ajaxTree);}if(j.elevenTree){f(i,j.elevenTree);}return k;};return d;})();