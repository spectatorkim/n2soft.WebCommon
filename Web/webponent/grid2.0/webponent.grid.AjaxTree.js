webponent.grid.AjaxTree=(function(){var a={};var e=null;var g=null;var b=null;a.init=function(h,i){e=$('<span class="CI-GRID-TREE-INDENTER"></span>');g=$('<a href="#" class="CI-GRID-TREE-EXPANDER">&nbsp;</a>');d(h,i.generatorParam,i.ajaxUrl);};function d(h,i,j){$(h.markup.area).on("click","a.CI-GRID-TREE-EXPANDER",function(n){n.preventDefault();n.stopImmediatePropagation();var m=$(this),l=m.closest("TR"),k=l[0].index;if(l.hasClass("CI-GRID-TREE-COLLAPSED")){$.ajax({type:"post",dataType:"json",url:j,data:$.param(l.data()),success:function(o){b=l;h.appendRow(o,k);l.removeClass("CI-GRID-TREE-COLLAPSED").addClass("CI-GRID-TREE-EXPANDED");b=null;}});}else{if(l.hasClass("CI-GRID-TREE-EXPANDED")){h.removeRow(k+1,k+f(l,l.data("__DEPTH__"),h)+1);l.removeClass("CI-GRID-TREE-EXPANDED").addClass("CI-GRID-TREE-COLLAPSED");}}return false;});h.on("rowRendered",function(m,n,l,k){c($(n),l,i);});}function c(o,n,j){var k=n.__HAS_CHILD__==="true",m=b==null?0:b.data("__DEPTH__")+1;var l=e.clone().css("padding-left",(m*15)+"px"),h=g.clone();if(k){o.addClass("CI-GRID-TREE-COLLAPSED");}else{h.removeAttr("href");}l.append(h);o.data("__DEPTH__",m);if(typeof j==="function"){var i=j(n);for(var p in i){o.data(p,i[p]);}}o.find("TD:not([name=CI_GRID_CHECKBOX_CONTAINER]):eq(0)").prepend(l);}function f(j,k,h){if(j[0].index==(h.rows.length-1)){return 0;}var i=0,j=$(h.rows[j[0].index+1]);while(j.data("__DEPTH__")!=undefined&&k!=undefined&&j.data("__DEPTH__")>k){i++;if(j[0].index==h.rows.length-1){break;}j=$(h.rows[j[0].index+1]);}return i;}return a;})();